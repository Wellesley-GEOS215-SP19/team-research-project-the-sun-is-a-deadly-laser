% Jocelyn and Leafia
%%
%MIDAS dataset from hell 
%making a .mat file for this v lorge dataset

%%
%rad_ttds = tabularTextDatastore('/Users/leafiasheradencox/Desktop/GEOS 215/GitHub/team-research-project-the-sun-is-a-deadly-laser/MIDAS Global Solar Data');
rad_ttds = tabularTextDatastore('/Users/leafiasheradencox/Desktop/GEOS 215/GitHub/MIDAS Global Solar Data');

rad_ttds.VariableNames = {'ID','ID_TYPE','OB_END_TIME','OB_HOUR_COUNT','VERSION_NUM','MET_DOMAIN_NAME','SRC_ID','REC_ST_IND','GLBL_IRAD_AMT','DIFU_IRAD_AMT','GLBL_IRAD_AMT_Q','DIFU_IRAD_AMT_Q','METO_STMP_TIME','MIDAS_STMP_ETIME','DIRECT_IRAD','IRAD_BAL_AMT','GLBL_S_LAT_IRAD_AMT','GLBL_HORZ_ILMN','YEAR','MONTH','LAT','LON'};%,DIRECT_IRAD_Q, IRAD_BAL_AMT_Q, GLBL_S_LAT_IRAD_AMT_Q, GLBL_HORZ_ILMN_Q 
rad_ttds.TextscanFormats = {'%q','%q','%{uuuu-MM-dd HH:mm}D','%f','%f','%q','%f','%f','%f','%f','%f','%f','%f','%f','%f','%f','%q','%f','%f','%f','%f','%f'};
rad_ttds.SelectedVariableNames = {'OB_END_TIME','SRC_ID','GLBL_IRAD_AMT','LAT','LON','MONTH','YEAR'};
%%
radiation_data = readall(rad_ttds); %this takes forever
radiation_data_ = read(rad_ttds);
%%
radiation_data.MONTH = month(radiation_data.OB_END_TIME);
radiation_data.YEAR = year(radiation_data.OB_END_TIME);
%%
%radiation_data.LAT = lat from station_ids.mat that corresponds to matching src_id
%radiation_data.LON = lat from station_ids.mat that corresponds to matching src_id
%%
%filename_rad = 'radiation_data.mat';
%m_rad = matfile(filename_rad);

save('radiation_data.mat','radiation_data');
